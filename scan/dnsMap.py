from nslookup import Nslookup
from passComand import codeFunction, printReport, passCommand
import dns
import dns.resolver

def nsScan(webpage):
    code='nslookup '+webpage
    codeFunction(code,'nslookup',webpage)

def nsScanPage(webpage, host):
    print("\nnslookup:\n")
    
    dns_query = Nslookup()
    dns = Nslookup(dns_servers=[host], verbose=True, tcp=True)
    
    ips_record = dns_query.dns_lookup(webpage)
    result1=print(ips_record.response_full, ips_record.answer)
    printReport(result1,'nslookup-dns',webpage)

    soa_record = dns_query.soa_lookup(webpage)
    result2=print(soa_record.response_full, soa_record.answer)
    printReport(result2,'nslookup-soa',webpage)

def subfinderSearch(webpage):
    code='subfinder -d '+webpage + ' -v'
    codeFunction(code,'subfinder',webpage)