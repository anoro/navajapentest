from passComand import codeFunction, printReport, passCommand

def scanWP(webpage):
    enumWPPassive(webpage)
    enumWPActive(webpage)
    

def enumWPPassive(url):
    print("\nGet Wordpress version passive\n")
    passCommand('curl '+url+' | grep "content=WordPress"')
    print("\nGet Plug-ins\n")
    passCommand('curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E '+"'wp-content/plugins/'" +
                ' | sed -E '+"'s,href=|src=,THIIIIS,g'"+" | awk -F 'THIIIIS' '{print $2}' "+'| cut -d "'" -f2")
    print("\nGet Themes\n")
    passCommand('curl -s -X GET https://wordpress.org/support/article/pages/ | grep -E '+"'wp-content/themes'" +
                ' | sed -E '+"'s,href=|src=,THIIIIS,g'"+" | awk -F 'THIIIIS' '{print $2}' "+'| cut -d "'" -f2")
    print("\nExtract versions in general\n")
    passCommand('curl -s -X GET https://wordpress.org/support/article/pages/ | grep http| grep -E '+"'?ver='" +
                ' | sed -E '+ "'s,href=|src=,THIIIIS,g'"+" | awk -F 'THIIIIS' '{print $2}' "+'| cut -d "'" -f2")



def enumWPActive(url):
    print("\nActive enumerations\n")
    print("\nBruteForce ID:\n")
    code1="curl -s -X GET "+url
    codeFunction(code1,'EnumWPBruteforce1',url)

    code3="curl -s -X GET "+url+"/?author=1"
    codeFunction(code3,'EnumWPBruteforce2',url)
    
    print("\nwp-json:\n")
    code2="curl "+url+"/wp-json/wp/v2/users"
    codeFunction(code2,'EnumWordpressJson',url)
    
